apiVersion: v1
kind: Pod
metadata:
  name: jupyter-session-template
  namespace: neuais-colab
  labels:
    app: jupyter-session
spec:
  restartPolicy: Never
  containers:
  - name: jupyter
    image: neuais/jupyter:latest
    ports:
    - containerPort: 8888
      name: jupyter
    env:
    - name: JUPYTER_ENABLE_LAB
      value: "yes"
    - name: NVIDIA_VISIBLE_DEVICES
      value: "0"  # Will be set dynamically
    resources:
      requests:
        memory: "8Gi"
        cpu: "4"
        nvidia.com/gpu: 1
      limits:
        memory: "16Gi"
        cpu: "8"
        nvidia.com/gpu: 1
    volumeMounts:
    - name: workspace
      mountPath: /home/jovyan/work
    - name: datasets
      mountPath: /home/jovyan/data
      readOnly: true
  volumes:
  - name: workspace
    persistentVolumeClaim:
      claimName: workspaces-pvc
  - name: datasets
    persistentVolumeClaim:
      claimName: datasets-pvc
  nodeSelector:
    nvidia.com/gpu: "true"
    node-role: gpu-worker
  tolerations:
  - key: nvidia.com/gpu
    operator: Exists
    effect: NoSchedule
